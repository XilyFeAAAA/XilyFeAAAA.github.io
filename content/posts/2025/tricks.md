---
title: "Python Tricks"
date: '2025-10-19T17:59:11+08:00'
authors: [Xilyfe]
series: ["Python 技巧"]
tags: ["Python"]
--- 


## 如何实现给一个类成员函数绑定事件

> 场景：插件系统中，需要给插件的函数绑定`on_message`，当收到消息时候调用函数。


一切都是**绑定方法**和**未绑定方法**的处理

方案1：

1. `@on_message`装饰器给需要的插件添加`metadata`
2. 在`__init__`中，遍历全部成员函数，如果有`metadata`，就从self上getattr下来这个**绑定方法**
3. 在加载插件时候实例化插件类

方案2：

1. `@on_message`装饰器直接记录**未绑定方法**，以及它对应的模块
2. 在加载插件时候，根据所在模块找到全部**未绑定方法**
3. 实例化插件类，通过`functools.partial`把插件实例作为第一个参数（也就是self）绑定到原始处理函数上，这时候就得到了**绑定方法**